<html lang="en" class="bg-gray-200">
<head>
    <%- include('../partials/head.ejs') %>
    <title>Dashboard</title>
</head>
<body class="">
    <%- include('../partials/drawer.ejs') %>

    <main>
        <div id="content" class="!p-0 min-h-screen bg-gray-200">
            <div class="max-w-[1100px] mx-auto px-3">
                <div class="text-center pt-9">
                    <img class="w-32 h-32 rounded-full mx-auto" src="assets/profile-img/<%= `${user.eth_address}.jpg` %>" onerror="this.onerror=null; this.src='assets/upload-default.jpg';" alt="">
                    <h1 class="mt-10 text-2xl">Welcome, <%= user.name %></h1>
                    <div class="mt-3 flex justify-center items-center text-xl flex-wrap gap-2">
                        <h1 class="">Your ETH address is:</h1>
                        <span id="eth-address" class="font-bold truncate"><%= user.eth_address %></span>
                        <ion-icon id="copy-eth-address" name="copy-outline" class="cursor-pointer"></ion-icon>
                        <ion-icon id="copy-eth-address-check" name="checkmark-outline" class="hidden"></ion-icon>
                    </div>
                </div>

                <div class="dashboard-tile">
                    <h1 class="">Profile Status</h1>
                    <div class="mt-4 grid grid-cols-3 gap-3">
                        <% Object.entries(verification).forEach(([key, value]) => { %>
                            <div>
                                <div class="h-2 rounded-md <%= value ? 'background-secondary' : 'background-gray' %>"></div>
                                <div class="mt-3 flex items-center gap-2">
                                    <ion-icon class="text-xl text-red-500 <%= value ? 'hidden' : '' %>" name="close-circle-outline"></ion-icon>
                                    <ion-icon class="text-xl text-green-500 <%= value ? '' : 'hidden' %>" name="checkmark-circle-outline"></ion-icon>
                                    <p class="inline-block"><%= key %> Verified</p>
                                </div>
                            </div>
                        <% }) %>
                    </div>
                </div>

                <div class="dashboard-tile">
                    <h1>Your Lands</h1>
                    <p class="mt-4">You have <span class="text-2xl font-bold"><%= ownedLands %></span> verified and owned land(s)</p>
                    <div class="mt-5 flex gap-4">
                        <a href="/land-map" class="btn btn-secondary">View All Lands</a>
                        <!-- <button class="btn btn-outline-secondary">View Transactions</button> -->
                    </div>
                </div>

                <div class="dashboard-tile">
                    <h1>Current Transactions</h1>
                    <p class="mt-4">You have <span class="text-2xl font-bold"><%= transactions %></span> active transaction(s)</p>
                    <div class="mt-5 flex gap-4">
                        <!-- <a href="/land-map" class="btn btn-secondary">Create Transaction</a> -->
                        <a href="/transactions" class="btn btn-secondary">View Transactions</a>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script src="https://cdn.jsdelivr.net/npm/jquery@3.7.1/dist/jquery.min.js"></script>
    <script type="module" src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.esm.js"></script>
    <script nomodule src="https://unpkg.com/ionicons@7.1.0/dist/ionicons/ionicons.js"></script>

    <script src="./js/functions.js"></script>
    <script src="./js/drawer.js"></script>

    <script>
        document.querySelector('#copy-eth-address').addEventListener('click', e => {
            navigator.clipboard.writeText(document.querySelector('#eth-address').textContent);
            document.querySelector('#copy-eth-address-check').classList.toggle('hidden');
            document.querySelector('#copy-eth-address').classList.toggle('hidden');

            setTimeout(() => {
                document.querySelector('#copy-eth-address-check').classList.toggle('hidden');
                document.querySelector('#copy-eth-address').classList.toggle('hidden');
            }, 2000);
        });
    </script>
</body>
</html>